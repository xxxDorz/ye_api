"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkAntdVersion = void 0;
const semver_1 = __importDefault(require("semver"));
const resolveProjectDep_1 = require("./resolveProjectDep");
const checkAntdVersion = (api) => {
    if (
    // @ts-ignore
    (api.pkg.dependencies && api.pkg.dependencies['antd']) ||
        // @ts-ignore
        (api.pkg.devDependencies && api.pkg.devDependencies['antd']) ||
        // egg project using `clientDependencies` in ali tnpm
        // @ts-ignore
        (api.pkg.clientDependencies && api.pkg.clientDependencies['antd'])) {
        let version = '4.23.0';
        try {
            // modifyConfig 的时候 api.paths 为 {}
            const nodeModulesPath = (0, resolveProjectDep_1.resolveProjectDep)({
                pkg: api.pkg,
                cwd: api.cwd,
                dep: 'antd',
            }) || `${api.cwd}/node_modules/antd`;
            version = require(`${nodeModulesPath}/package.json`).version;
        }
        catch (error) { }
        return semver_1.default.lt('4.22.8', version);
    }
    return true;
};
exports.checkAntdVersion = checkAntdVersion;
